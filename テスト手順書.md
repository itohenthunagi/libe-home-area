# テスト手順書

## 目的

実装した対応エリア確認システムが正しく動作するかを確認します。

## テスト環境

- ブラウザ：Chrome, Safari, Edge（最新版）
- デバイス：PC, タブレット, スマートフォン
- 接続：インターネット接続必須（CSV読み込みのため）

---

## テストケース

### T01: ページ読み込み

**手順：**
1. `new_index.html` をブラウザで開く

**期待結果：**
- [ ] ページが正常に表示される
- [ ] ヘッダーに「対応エリア確認」が表示される
- [ ] 都道府県プルダウンに「選択」が表示される
- [ ] 市区町村入力欄がある
- [ ] 「確認する」ボタンがある
- [ ] フッターに「お問い合わせ」リンクがある

**確認方法：**
- ブラウザのコンソール（F12）でエラーがないか確認

---

### T02: CSV読み込み

**手順：**
1. ページを開いて数秒待つ
2. 都道府県プルダウンをクリック

**期待結果：**
- [ ] 都道府県リストが表示される（北海道、青森県、...）
- [ ] 重複なく表示される
- [ ] 「選択」以外に47都道府県が含まれる

**確認方法：**
- プルダウンを開いて目視確認
- コンソールで `appData.rowsByPref.size` を実行 → 47が表示される

---

### T03: 都道府県選択

**手順：**
1. 都道府県プルダウンから「北海道」を選択

**期待結果：**
- [ ] 市区町村入力欄がアクティブになる
- [ ] 市区町村入力欄にフォーカスすると候補が表示される

---

### T04: 市区町村サジェスト（ひらがな入力）

**手順：**
1. 都道府県：「北海道」を選択
2. 市区町村：「さっぽ」と入力

**期待結果：**
- [ ] datalist候補に「札幌市」が表示される
- [ ] 入力を続けると候補が絞り込まれる

---

### T05: 市区町村サジェスト（漢字入力）

**手順：**
1. 都道府県：「北海道」を選択
2. 市区町村：「札幌」と入力

**期待結果：**
- [ ] datalist候補に「札幌市」が表示される

---

### T06: 正常検索（対応可能エリア）

**手順：**
1. 都道府県：「北海道」
2. 市区町村：「札幌市」
3. 「確認する」ボタンをクリック

**期待結果：**
- [ ] 「検索中...」が一瞬表示される
- [ ] 結果ヘッダーに「北海道 札幌市」が表示される
- [ ] サービス一覧（工務店 ― 大規模リフォームなど）が表示される
- [ ] ステータスバッジ（○、要相談、対応エリア外など）が表示される
- [ ] 各カードが正しいスタイルで表示される

**確認項目：**
- [ ] 大規模リフォーム：○（緑）
- [ ] 小規模リフォーム：○（緑）
- [ ] その他：データ通りに表示

---

### T07: 正常検索（要相談エリア）

**手順：**
1. 都道府県：「北海道」
2. 市区町村：「旭川市」
3. 「確認する」ボタンをクリック

**期待結果：**
- [ ] 結果ヘッダーに「北海道 旭川市」が表示される
- [ ] 「要相談」のステータスがオレンジ色で表示される

---

### T08: 正常検索（対応エリア外）

**手順：**
1. 都道府県：「北海道」
2. 市区町村：「函館市」（データが空欄の市区町村）
3. 「確認する」ボタンをクリック

**期待結果：**
- [ ] 結果ヘッダーに「北海道 函館市」が表示される
- [ ] すべてのステータスが「対応エリア外」（グレー）で表示される

---

### T09: エラー - 都道府県未選択

**手順：**
1. 都道府県：（選択しない）
2. 市区町村：「札幌市」
3. 「確認する」ボタンをクリック

**期待結果：**
- [ ] エラーメッセージ「都道府県を選択してください」が表示される
- [ ] 結果は表示されない

---

### T10: エラー - 市区町村未入力

**手順：**
1. 都道府県：「北海道」
2. 市区町村：（入力しない）
3. 「確認する」ボタンをクリック

**期待結果：**
- [ ] エラーメッセージ「市区町村を入力してください」が表示される
- [ ] 結果は表示されない

---

### T11: エラー - 候補外入力

**手順：**
1. 都道府県：「北海道」
2. 市区町村：「存在しない市」と手入力
3. 「確認する」ボタンをクリック

**期待結果：**
- [ ] エラーメッセージ「市区町村は候補（プルダウン）から選択してください」が表示される
- [ ] 結果は表示されない

---

### T12: お問い合わせリンク

**手順：**
1. フッターの「お問い合わせ」リンクをクリック

**期待結果：**
- [ ] 新しいタブで問い合わせフォームが開く
- [ ] URLが設定したCONTACT_URLと一致

---

### T13: レスポンシブデザイン（モバイル）

**手順：**
1. ブラウザの開発者ツールでモバイルビュー（375px）に切り替え
2. ページを確認

**期待結果：**
- [ ] 都道府県・市区町村が縦2列で表示される
- [ ] ボタンがフル幅で表示される
- [ ] 結果カードが1列で表示される
- [ ] フォントサイズが適切

---

### T14: レスポンシブデザイン（タブレット）

**手順：**
1. ブラウザの開発者ツールでタブレットビュー（768px）に切り替え
2. ページを確認

**期待結果：**
- [ ] 都道府県・市区町村が横2列で表示される
- [ ] レイアウトが適切に調整される

---

### T15: レスポンシブデザイン（PC）

**手順：**
1. PCブラウザ（1024px以上）で表示

**期待結果：**
- [ ] カードが中央寄せで表示される
- [ ] 最大幅640pxで制限される
- [ ] ボタンが中央寄せ（最大幅300px）

---

### T16: サジェストのdebounce動作

**手順：**
1. 都道府県：「北海道」
2. 市区町村：高速で「さっぽろ」と入力

**期待結果：**
- [ ] 入力中は候補更新が一時停止する
- [ ] 入力停止後200ms後に候補が更新される
- [ ] パフォーマンスが良好

**確認方法：**
- コンソールで `requestSuggest` の呼び出し回数を確認（debounceなしだと文字数分、ありだと1回）

---

### T17: 複数検索

**手順：**
1. 「北海道 札幌市」で検索
2. 都道府県を「東京都」に変更
3. 市区町村を「新宿区」に変更
4. 再度検索

**期待結果：**
- [ ] 前回の結果がクリアされる
- [ ] 新しい結果が正しく表示される
- [ ] エラーメッセージがクリアされる

---

### T18: ブラウザ互換性（Chrome）

**手順：**
1. Google Chromeで `new_index.html` を開く
2. 上記テストケースを実行

**期待結果：**
- [ ] すべての機能が正常に動作

---

### T19: ブラウザ互換性（Safari）

**手順：**
1. Safariで `new_index.html` を開く
2. 上記テストケースを実行

**期待結果：**
- [ ] すべての機能が正常に動作
- [ ] フォント・スタイルが正しく表示

---

### T20: ブラウザ互換性（Edge）

**手順：**
1. Microsoft Edgeで `new_index.html` を開く
2. 上記テストケースを実行

**期待結果：**
- [ ] すべての機能が正常に動作

---

## パフォーマンステスト

### P01: CSV読み込み速度

**手順：**
1. ページを開く
2. ブラウザのNetwork タブで確認

**期待結果：**
- [ ] CSV読み込み完了まで2秒以内
- [ ] UI初期化完了まで3秒以内

---

### P02: 検索速度

**手順：**
1. 「確認する」ボタンをクリック
2. 結果表示までの時間を計測

**期待結果：**
- [ ] 検索完了まで300ms以内（設定したsetTimeout含む）
- [ ] 体感的に高速

---

## セキュリティチェック

### S01: CSV公開範囲

**手順：**
1. CSVのURLをブラウザで直接開く

**期待結果：**
- [ ] 公開してよい情報のみが含まれている
- [ ] 個人情報・社内情報が含まれていない

---

### S02: XSS脆弱性チェック

**手順：**
1. 市区町村に `<script>alert('XSS')</script>` を入力して検索

**期待結果：**
- [ ] スクリプトが実行されない
- [ ] エラーメッセージが正常に表示される

---

## 不具合報告

不具合を発見した場合は、以下の情報を記録してください：

- **テストケース番号**：
- **ブラウザ・バージョン**：
- **OS**：
- **再現手順**：
- **期待結果**：
- **実際の結果**：
- **スクリーンショット**：
- **コンソールエラー**：

---

## テスト完了チェックリスト

- [ ] T01〜T20: すべてのテストケースが通過
- [ ] P01〜P02: パフォーマンステスト合格
- [ ] S01〜S02: セキュリティチェック合格
- [ ] 不具合がすべて修正された

---

**テスト実施者：**
**テスト日時：**
**テスト結果：** 合格 / 不合格
**備考：**
